{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\n\nconst galleryWrapperEl= document.querySelector('.gallery')\nconst inputValue = document.querySelector('.search-form');\nconst loader = document.querySelector('.loader')\nconst search = document.querySelector('.search')\nconst loadMoreBtn = document.querySelector('.load-btn')\nconst jsText = document.querySelector('.js-text')\nconst photoCard = document.querySelector('.photo-card')\n\n\nconst BASE_URL = 'https://pixabay.com/api/'\nconst API_KEY = '41296916-da04ab2f63441e92262fae4bb'\n\ninputValue.addEventListener('submit', onSearch);\nloadMoreBtn.addEventListener('click', onClickLoadMoreBtn);\n\n\nlet page = 1;\nlet totalHits = 0;\n\n\nfunction changeTitleOnBtn() {\n  search.classList.add('loader')\n  search.textContent = '';\n};\n\n\nfunction removeClassOnBtn() {\n  search.classList.remove('loader');\n  search.textContent = 'Search';\n};\n\nfunction changeTitleOnLoadeMoreBtn() {\n  loadMoreBtn.classList.add('loader')\n  loadMoreBtn.textContent = '';\n\n};\n\nfunction removeClassOnLoadeMoreBtn() {\n  loadMoreBtn.classList.remove('loader');\n  loadMoreBtn.textContent = 'Load more';\n};\n\nasync function onClickLoadMoreBtn() { \n  page += 1;\n  changeTitleOnLoadeMoreBtn()\n  const localStorageData = localStorage.getItem('inputValue');\n  const formData = JSON.parse(localStorageData)\n  const post = await fetchPicture(formData);\n\n  renderCard(post);\n  removeClassOnLoadeMoreBtn()\n};\n\nasync function onSearch(event) {\n  event.preventDefault(); \n  loadMoreBtn.classList.add('load-hidden');\n  jsText.textContent = '';\n  changeTitleOnBtn();\n  clearMarcup()\n  \n  const form = event.currentTarget;\n  const searchQuery = form.elements.query.value;\n  localStorage.setItem('inputValue', JSON.stringify(searchQuery)); \n  const post = await fetchPicture(searchQuery);\n\n  renderCard(post)\n  form.reset()\n  removeClassOnBtn();\n  \n};\n\n\n\nasync function fetchPicture(search) {\n  try {\n    const response = await axios.get(BASE_URL, {\n    params: {\n        key: API_KEY,\n        q: search,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: 40,\n        page: page,\n    },\n}) \n  return response.data;\n  } catch (error) {\n    onError(error)\n  }\n};\n\n\nasync function renderCard(res) { \n  totalHits += res.hits.length;\n  if (totalHits > res.totalHits ) {\n    loadMoreBtn.classList.add('load-hidden');\n    jsText.textContent = \"We're sorry, but you've reached the end of search results.\";\n  } else {\n    loadMoreBtn.classList.remove('load-hidden');\n    jsText.textContent = '';\n  }\n\n  if (res.total === 0) {\n    onWarning()\n  } else {\n    const markup = await createMarkup(res.hits);\n  galleryWrapperEl.insertAdjacentHTML('beforeend', markup)\n    \n  const lightbox = new SimpleLightbox('.gallery a', { \n          captions: true,\n          captionsData: 'alt',\n          captionPosition: 'bottom',\n          captionDelay: 250,\n        })\n          .refresh(); \n  };\n\nif (totalHits > 40) {\n        const { height: cardHeight } =\n          galleryWrapperEl.firstElementChild.getBoundingClientRect();\n          console.log(cardHeight);\n        window.scrollBy({\n          top: cardHeight * 2,\n          behavior: 'smooth',\n        });\n      }\n\n};\n\n\nfunction createMarkup(arr) {\nreturn arr\n      .map(\n        ({\n          webformatURL,\n          largeImageURL,\n          tags,\n          likes,\n          views,\n          comments,\n          downloads,\n        }) => {\n          return `\n          <div class=\"photo-card .shadow-drop-2-center\">\n              <a class=\"gallery__link\" href=\"${largeImageURL}\">\n                <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n              </a>\n              <div class=\"info\">\n                <p class=\"info-item\">\n                  <b>Likes: ${likes}</b>\n                </p>\n                <p class=\"info-item\">\n                  <b>Views: ${views}</b>\n                </p>\n                <p class=\"info-item\">\n                  <b>Comments: ${comments}</b>\n                </p>\n                <p class=\"info-item\">\n                  <b>Downloads: ${downloads}</b>\n                </p>\n              </div>\n            </div>`;\n        }\n      )\n      .join('');\n  \n    \n};\n\nfunction onWarning() {\n    iziToast.warning({\n    title: 'Caution',\n      message: \"Sorry, there are no images matching your search query. Please try again!\",\n    \n    });\n  clearMarcup()\n};\n\nfunction onError(error) {\n  iziToast.error({\n    title: 'Error',\n    message: `${error.message}`,\n});\n}\n\nfunction clearMarcup() {\n  galleryWrapperEl.innerHTML = '';\n  totalHits = 0;\n  page = 1;\n};\n\n\n \n// function fetchPicture(search) {\n//   return fetch(`${BASE_URL}?key=${API_KEY}&q=${search}&image_type=photo&orientation=horizontal&safesearch=true`)\n//     .then((response) => {\n//       return response.json()\n//     })\n//     .catch(error => {\n//       console.log('error');\n//     });\n        \n// };\n\n \n\n// function renderCard(res) {\n  \n//   // const respHits =res.data;\n//   console.log(res);\n//   if (res.total === 0) {\n//     onWarning()\n//   } else {\n//    const markup = createMarkup(res.hits )\n//   galleryWrapperEl.innerHTML = markup;}\n  \n//   const lightbox = new SimpleLightbox('.gallery a', {\n//           captions: true,\n//           captionsData: 'alt',\n//           captionPosition: 'bottom',\n//           captionDelay: 250,\n//         })\n//           .refresh();\n       \n// };\n\n// function onSerch(event) {\n//     event.preventDefault(); \n//     changeTitleOnBtn()\n//     clearMarcup\n//     const form = event.currentTarget;\n//     const searchQuery = form.elements.query.value;\n//   fetchPicture(searchQuery)\n//     .then(renderCard)\n//     .finally(() => form.reset()).then(() => { removeClassOnBtn() });\n\n// };"],"names":["galleryWrapperEl","inputValue","search","loadMoreBtn","jsText","BASE_URL","API_KEY","onSearch","onClickLoadMoreBtn","page","totalHits","changeTitleOnBtn","removeClassOnBtn","changeTitleOnLoadeMoreBtn","removeClassOnLoadeMoreBtn","localStorageData","formData","post","fetchPicture","renderCard","event","clearMarcup","form","searchQuery","axios","error","onError","res","onWarning","markup","createMarkup","SimpleLightbox","cardHeight","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","iziToast"],"mappings":"owBASA,MAAMA,EAAkB,SAAS,cAAc,UAAU,EACnDC,EAAa,SAAS,cAAc,cAAc,EACzC,SAAS,cAAc,SAAS,EAC/C,MAAMC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAc,SAAS,cAAc,WAAW,EAChDC,EAAS,SAAS,cAAc,UAAU,EAC9B,SAAS,cAAc,aAAa,EAGtD,MAAMC,EAAW,2BACXC,EAAU,qCAEhBL,EAAW,iBAAiB,SAAUM,CAAQ,EAC9CJ,EAAY,iBAAiB,QAASK,CAAkB,EAGxD,IAAIC,EAAO,EACPC,EAAY,EAGhB,SAASC,GAAmB,CAC1BT,EAAO,UAAU,IAAI,QAAQ,EAC7BA,EAAO,YAAc,EACvB,CAGA,SAASU,GAAmB,CAC1BV,EAAO,UAAU,OAAO,QAAQ,EAChCA,EAAO,YAAc,QACvB,CAEA,SAASW,GAA4B,CACnCV,EAAY,UAAU,IAAI,QAAQ,EAClCA,EAAY,YAAc,EAE5B,CAEA,SAASW,GAA4B,CACnCX,EAAY,UAAU,OAAO,QAAQ,EACrCA,EAAY,YAAc,WAC5B,CAEA,eAAeK,GAAqB,CAClCC,GAAQ,EACRI,EAA2B,EAC3B,MAAME,EAAmB,aAAa,QAAQ,YAAY,EACpDC,EAAW,KAAK,MAAMD,CAAgB,EACtCE,EAAO,MAAMC,EAAaF,CAAQ,EAExCG,EAAWF,CAAI,EACfH,EAA2B,CAC7B,CAEA,eAAeP,EAASa,EAAO,CAC7BA,EAAM,eAAc,EACpBjB,EAAY,UAAU,IAAI,aAAa,EACvCC,EAAO,YAAc,GACrBO,IACAU,EAAa,EAEb,MAAMC,EAAOF,EAAM,cACbG,EAAcD,EAAK,SAAS,MAAM,MACxC,aAAa,QAAQ,aAAc,KAAK,UAAUC,CAAW,CAAC,EAC9D,MAAMN,EAAO,MAAMC,EAAaK,CAAW,EAE3CJ,EAAWF,CAAI,EACfK,EAAK,MAAO,EACZV,GAEF,CAIA,eAAeM,EAAahB,EAAQ,CAClC,GAAI,CAYJ,OAXmB,MAAMsB,EAAM,IAAInB,EAAU,CAC3C,OAAQ,CACJ,IAAKC,EACL,EAAGJ,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,KAAMO,CACT,CACL,CAAC,GACiB,IACf,OAAQgB,EAAP,CACAC,EAAQD,CAAK,CACd,CACH,CAGA,eAAeN,EAAWQ,EAAK,CAU7B,GATAjB,GAAaiB,EAAI,KAAK,OAClBjB,EAAYiB,EAAI,WAClBxB,EAAY,UAAU,IAAI,aAAa,EACvCC,EAAO,YAAc,+DAErBD,EAAY,UAAU,OAAO,aAAa,EAC1CC,EAAO,YAAc,IAGnBuB,EAAI,QAAU,EAChBC,EAAW,MACN,CACL,MAAMC,EAAS,MAAMC,EAAaH,EAAI,IAAI,EAC5C3B,EAAiB,mBAAmB,YAAa6B,CAAM,EAEtC,IAAIE,EAAe,aAAc,CAC1C,SAAU,GACV,aAAc,MACd,gBAAiB,SACjB,aAAc,GACxB,CAAS,EACE,QAAU,CAErB,CACA,GAAIrB,EAAY,GAAI,CACZ,KAAM,CAAE,OAAQsB,CAAY,EAC1BhC,EAAiB,kBAAkB,wBACnC,QAAQ,IAAIgC,CAAU,EACxB,OAAO,SAAS,CACd,IAAKA,EAAa,EAClB,SAAU,QACpB,CAAS,CACF,CAEP,CAGA,SAASF,EAAaG,EAAK,CAC3B,OAAOA,EACA,IACC,CAAC,CACC,aAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACV,IACiB;AAAA;AAAA,+CAE8BL;AAAA,4BACnBD,WAAsBE;AAAA;AAAA;AAAA;AAAA,8BAIpBC;AAAA;AAAA;AAAA,8BAGAC;AAAA;AAAA;AAAA,iCAGGC;AAAA;AAAA;AAAA,kCAGCC;AAAA;AAAA;AAAA,mBAK3B,EACA,KAAK,EAAE,CAGd,CAEA,SAASZ,GAAY,CACjBa,EAAS,QAAQ,CACjB,MAAO,UACL,QAAS,0EAEf,CAAK,EACHpB,EAAa,CACf,CAEA,SAASK,EAAQD,EAAO,CACtBgB,EAAS,MAAM,CACb,MAAO,QACP,QAAS,GAAGhB,EAAM,SACtB,CAAC,CACD,CAEA,SAASJ,GAAc,CACrBrB,EAAiB,UAAY,GAC7BU,EAAY,EACZD,EAAO,CACT"}